<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unofficial BDC & Insight Apps Calculator</title>
    <style>
        :root {
            --primary-bg: #f0f8ff;
            --border-color: #a0c0e0;
            --highlight-color: #2c7be5;
            --text-color: #333;
            --result-color: #0066cc;
            --disabled-color: #aaa;
            --section-bg: #ffffff;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--primary-bg);
            color: var(--text-color);
            line-height: 1.6;
            font-size: 14px;
            padding: 10px;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .title {
            width: 100%;
            text-align: center;
            padding: 10px;
            color: var(--highlight-color);
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            background-color: var(--section-bg);
        }
        
        .output-section {
            flex: 1;
            min-width: 300px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            background-color: var(--section-bg);
        }
        
        .reference-section {
            flex: 1;
            min-width: 300px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            background-color: var(--section-bg);
            text-align: center;
        }
        
        .section-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--highlight-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }
        
        .input-group {
            margin-bottom: 10px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .input-group label {
            flex: 1;
            min-width: 150px;
            margin-right: 10px;
        }
        
        .input-group input[type="number"] {
            width: 100px;
            padding: 3px 5px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
        }
        
        .input-group input[type="checkbox"] {
            margin-right: 5px;
        }
        
        .input-group select {
            width: 100px;
            padding: 3px 5px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
        }
        
        .result-item {
            margin-bottom: 10px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .result-item .label {
            flex: 2;
            min-width: 200px;
        }
        
        .result-item .value {
            flex: 1;
            min-width: 50px;
            color: var(--result-color);
            font-weight: 600;
        }
        
        .result-item .note {
            width: 100%;
            font-size: 12px;
            color: var(--disabled-color);
            margin-top: 2px;
            margin-left: 10px;
        }
        
        .sub-item {
            margin-left: 15px;
            margin-bottom: 5px;
        }
        
        .disabled {
            color: var(--disabled-color);
            cursor: not-allowed;
        }
        
        .reference-section img {
            max-width: 100%;
            height: auto;
            margin-top: 10px;
        }
        
        .reference-section a {
            color: var(--highlight-color);
            text-decoration: none;
        }
        
        .reference-section a:hover {
            text-decoration: underline;
        }
        
        @media (min-width: 768px) {
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: auto auto;
                grid-template-areas: 
                    "input output"
                    "input reference";
            }
            
            .title {
                grid-column: span 2;
            }
            
            .input-section {
                grid-area: input;
            }
            
            .output-section {
                grid-area: output;
            }
            
            .reference-section {
                grid-area: reference;
            }
        }
        
        @media (max-width: 767px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Unofficial BDC & Insight Apps Calculator</div>
        
        <div class="input-section">
            <div class="section-title">Insight Apps</div>
            <div class="input-group">
                <input type="checkbox" id="coreEnterpriseAnalytics" onchange="updateResults()">
                <label for="coreEnterpriseAnalytics">Core Enterprise Analytics</label>
            </div>
            <div class="input-group" id="riseGroup" style="display: none; margin-left: 20px;">
                <label for="risePCE">RISE PCE (FUE)</label>
                <input type="number" id="risePCE" min="0" value="0" onfocus="showReference('BDC_Core_AutoAttach.png')" onchange="updateResults()">
            </div>
            <div class="input-group">
                <input type="checkbox" disabled>
                <label class="disabled">People Analytics</label>
            </div>
            <div class="input-group">
                <input type="checkbox" disabled>
                <label class="disabled">Spend Analytics</label>
            </div>
            <div class="input-group">
                <input type="checkbox" disabled>
                <label class="disabled">Supply Chain Analytics</label>
            </div>
            <div class="input-group">
                <input type="checkbox" disabled>
                <label class="disabled">Customer Analytics</label>
            </div>
            <div class="input-group">
                <input type="checkbox" disabled>
                <label class="disabled">Finance Analytics</label>
            </div>
            <div class="input-group">
                <input type="checkbox" id="customerManagedDataProducts" onfocus="showReference('IA_CustomerManaged.png')" onchange="updateResults()">
                <label for="customerManagedDataProducts">Customer-Managed Data Products</label>
            </div>
            
            <div class="section-title">BDC Core Capacity</div>
            <div class="input-group">
                <label for="datasphereProduction">Datasphere Production (CU)</label>
                <input type="number" id="datasphereProduction" min="0" value="0" onfocus="showDatasphereReference()" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="datasphereQA">Datasphere QA (CU)</label>
                <input type="number" id="datasphereQA" min="0" value="0" onfocus="showDatasphereReference()" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="datasphereDEV">Datasphere DEV (CU)</label>
                <input type="number" id="datasphereDEV" min="0" value="0" onfocus="showDatasphereReference()" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="sacBI">SAC BI (Users, minimum 25)</label>
                <input type="number" id="sacBI" min="0" value="0" onfocus="showReference('BDC_Core_SAC.png')" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="sacPlanningStandard">SAC Planning Standard (Users, minimum 10)</label>
                <input type="number" id="sacPlanningStandard" min="0" value="0" onfocus="showReference('BDC_Core_SAC.png')" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="sacPlanningProfessional">SAC Planning Professional (Users, minimum 1)</label>
                <input type="number" id="sacPlanningProfessional" min="0" value="0" onfocus="showReference('BDC_Core_SAC.png')" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="sacTestTenant">SAC Test tenant (Users, minimum 20)</label>
                <input type="number" id="sacTestTenant" min="0" value="0" onfocus="showReference('BDC_Core_SAC.png')" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="bwPCE">BW PCE (CU)</label>
                <input type="number" id="bwPCE" min="0" value="0" onfocus="showBWReference()" onchange="updateResults()">
            </div>
            <div class="input-group">
                <label for="databricks">Databricks (T-shirt Sizing)</label>
                <select id="databricks" onfocus="showReference('BDC_Core_Databricks.png')" onchange="updateResults()">
                    <option value="n/a">n/a</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="XXL">XXL</option>
                </select>
            </div>
        </div>
        
        <div class="output-section">
            <div id="insightAppsResults" style="display: none;">
                <div class="result-item" id="coreEnterpriseResult" style="display: none;">
                    <div class="label">8019233 : Insight App - Core Enterprise Analytics (FUE)</div>
                    <div class="value" id="coreEnterpriseValue">0</div>
                </div>
                <div class="result-item" id="customerManagedResult" style="display: none;">
                    <div class="label">8019709 : Customer-Managed Data Products (CU - Flat Fee)</div>
                    <div class="value">1,000</div>
                </div>
            </div>
            
            <div class="result-item">
                <div class="label">8019271 : SAP Business Data Cloud Core Capacity (CU)</div>
                <div class="value" id="totalCUValue">0</div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - Auto-Attach of BDC CU based on Tier (CU)</div>
                <div class="value" id="autoAttachCUValue">0</div>
                <div class="note" id="autoAttachTierNote" style="display: none;"></div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - Datasphere (CU)</div>
                <div class="value" id="datasphereCUValue">0</div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - SAC BI (CU)</div>
                <div class="value" id="sacBICUValue">0</div>
                <div class="note" id="sacBINote" style="display: none;"></div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - SAC Planning Standard (CU)</div>
                <div class="value" id="sacPlanningStandardCUValue">0</div>
                <div class="note" id="sacPlanningStandardNote" style="display: none;"></div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - SAC Planning Professional (CU)</div>
                <div class="value" id="sacPlanningProfessionalCUValue">0</div>
                <div class="note" id="sacPlanningProfessionalNote" style="display: none;"></div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - SAC Test tenant (CU)</div>
                <div class="value" id="sacTestTenantCUValue">0</div>
                <div class="note" id="sacTestTenantNote" style="display: none;"></div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - BW PCE (CU)</div>
                <div class="value" id="bwPCECUValue">0</div>
            </div>
            
            <div class="sub-item result-item">
                <div class="label"> - SAP Databricks (CU)</div>
                <div class="value" id="databricksCUValue">0</div>
                <div class="note" id="databricksNote" style="display: none;"></div>
            </div>
        </div>
        
        <div class="reference-section">
            <img id="referenceImage" src="BDC_Packaging.png" alt="BDC Packaging Reference" style="max-width: 100%;">
            <div id="referenceLinks" style="margin-top: 10px;"></div>
        </div>
    </div>

    <script>
        // Tier Validation Table
        const tierTable = [
            { tier: 1, lowerBound: 60, upperBound: 84, units: 5700 },
            { tier: 2, lowerBound: 85, upperBound: 109, units: 6150 },
            { tier: 3, lowerBound: 110, upperBound: 135, units: 6600 },
            { tier: 4, lowerBound: 136, upperBound: 270, units: 9250 },
            { tier: 5, lowerBound: 271, upperBound: 410, units: 10000 },
            { tier: 6, lowerBound: 411, upperBound: 550, units: 11500 },
            { tier: 7, lowerBound: 551, upperBound: 750, units: 14350 },
            { tier: 8, lowerBound: 751, upperBound: 1000, units: 15750 },
            { tier: 9, lowerBound: 1001, upperBound: 2000, units: 21750 },
            { tier: 10, lowerBound: 2001, upperBound: 4000, units: 28000 },
            { tier: 11, lowerBound: 4001, upperBound: 6000, units: 38000 },
            { tier: 12, lowerBound: 6001, upperBound: 12000, units: 51350 },
            { tier: 13, lowerBound: 12001, upperBound: 25000, units: 59500 },
            { tier: 14, lowerBound: 25001, upperBound: Infinity, units: 71800 }
        ];
        
        // SAC BI Table
        const sacBITable = [
            { lowerBound: 25, upperBound: 200, capacityUnitValue: 25.60 },
            { lowerBound: 201, upperBound: 500, capacityUnitValue: 21.60 },
            { lowerBound: 501, upperBound: 1000, capacityUnitValue: 17.38 },
            { lowerBound: 1001, upperBound: 3000, capacityUnitValue: 15.95 },
            { lowerBound: 3001, upperBound: 5000, capacityUnitValue: 12.64 },
            { lowerBound: 5001, upperBound: Infinity, capacityUnitValue: 10.54 }
        ];
        
        // SAC Planning Standard Table
        const sacPlanningStandardTable = [
            { lowerBound: 10, upperBound: 200, capacityUnitValue: 72.85 },
            { lowerBound: 201, upperBound: 500, capacityUnitValue: 57.98 },
            { lowerBound: 501, upperBound: 1000, capacityUnitValue: 46.70 },
            { lowerBound: 1001, upperBound: Infinity, capacityUnitValue: 41.57 }
        ];
        
        // SAC Planning Professional Table
        const sacPlanningProfessionalTable = [
            { lowerBound: 1, upperBound: Infinity, capacityUnitValue: 820.43 }
        ];
        
        // SAC Test Tenant Table
        const sacTestTenantTable = [
            { lowerBound: 20, upperBound: Infinity, capacityUnitValue: 47.05 }
        ];
        
        // Databricks T-shirt Sizing Table
        const databricksTable = {
            "n/a": { cu: 0, details: "" },
            "S": { 
                cu: 2000, 
                details: "Total Data Size: 100GB, ETL/ML Developers: 2, Daily ETL volume: 10GB batch, Total ML models: 20" 
            },
            "M": { 
                cu: 5000, 
                details: "Total Data Size: 100GB, ETL/ML Developers: 10, Daily ETL volume: 10GB batch, Total ML models: 40" 
            },
            "L": { 
                cu: 10000, 
                details: "Total Data Size: 1TB, ETL/ML Developers: 2, Daily ETL volume: 10GB streaming, BI Dashboards: 10, SQL Analysts: 10 analysts 6hrs/day, Total ML models: 20, Real time inference GPU models: 10, Peak QPS of real time inference: 5 QPS for 8hrs/day" 
            },
            "XL": { 
                cu: 50000, 
                details: "Total Data Size: 1TB, ETL/ML Developers: 10, Daily ETL volume: 100GB streaming, BI Dashboards: 50, SQL Analysts: 25 analysts 6hrs/day, Total ML models: 100, Real time inference GPU models: 25, Peak QPS of real time inference: 100 QPS for 8hrs/day" 
            },
            "XXL": { 
                cu: 100000, 
                details: "Total Data Size: 5TB, ETL/ML Developers: 10, Daily ETL volume: 100GB streaming, BI Dashboards: 50, SQL Analysts: 25 analysts 6hrs/day, Total ML models: 50, Real time inference GPU models: 15, Peak QPS of real time inference: 100 QPS for 8hrs/day" 
            }
        };
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Set up the Core Enterprise Analytics checkbox to show/hide the RISE PCE input
            document.getElementById('coreEnterpriseAnalytics').addEventListener('change', function() {
                document.getElementById('riseGroup').style.display = this.checked ? 'flex' : 'none';
                updateResults();
            });
            
            // Initialize results
            updateResults();
        });
        
        // Show reference image and links
        function showReference(imageName) {
            document.getElementById('referenceImage').src = imageName;
            document.getElementById('referenceLinks').innerHTML = '';
        }
        
        // Show Datasphere reference
        function showDatasphereReference() {
            document.getElementById('referenceImage').src = 'BDC_Core_Datasphere.png';
            document.getElementById('referenceLinks').innerHTML = '<a href="https://dwc-pricing-calculator-sac-saceu10.cfapps.eu10.hana.ondemand.com/" target="_blank">SAP Datasphere Capacity Unit Estimator</a>';
        }
        
        // Show BW reference
        function showBWReference() {
            document.getElementById('referenceImage').src = 'BDC_Core_BW.png';
            document.getElementById('referenceLinks').innerHTML = '<a href="https://d.dam.sap.com/s/i/a/fWz4gcY?rc=10&doi=SAP1181174" target="_blank">BDC-BW Configurator XLS</a>';
        }
        
        // Calculate results
        function updateResults() {
            // Get input values
            const coreEnterpriseAnalytics = document.getElementById('coreEnterpriseAnalytics').checked;
            const risePCE = parseInt(document.getElementById('risePCE').value) || 0;
            const customerManagedDataProducts = document.getElementById('customerManagedDataProducts').checked;
            const datasphereProduction = parseInt(document.getElementById('datasphereProduction').value) || 0;
            const datasphereQA = parseInt(document.getElementById('datasphereQA').value) || 0;
            const datasphereDEV = parseInt(document.getElementById('datasphereDEV').value) || 0;
            const sacBI = parseInt(document.getElementById('sacBI').value) || 0;
            const sacPlanningStandard = parseInt(document.getElementById('sacPlanningStandard').value) || 0;
            const sacPlanningProfessional = parseInt(document.getElementById('sacPlanningProfessional').value) || 0;
            const sacTestTenant = parseInt(document.getElementById('sacTestTenant').value) || 0;
            const bwPCE = parseInt(document.getElementById('bwPCE').value) || 0;
            const databricksSize = document.getElementById('databricks').value;
            
            // Update Insight Apps Section
            document.getElementById('insightAppsResults').style.display = (coreEnterpriseAnalytics || customerManagedDataProducts) ? 'block' : 'none';
            
            // Update Core Enterprise Analytics result
            document.getElementById('coreEnterpriseResult').style.display = coreEnterpriseAnalytics ? 'flex' : 'none';
            document.getElementById('coreEnterpriseValue').textContent = coreEnterpriseAnalytics ? risePCE : 0;
            
            // Update Customer-Managed Data Products result
            document.getElementById('customerManagedResult').style.display = customerManagedDataProducts ? 'flex' : 'none';
            
            // Calculate Auto-Attach CU
            let autoAttachCU = 0;
            let tierInfo = '';
            
            if (coreEnterpriseAnalytics && risePCE > 0) {
                for (const tier of tierTable) {
                    if (risePCE >= tier.lowerBound && risePCE <= tier.upperBound) {
                        autoAttachCU = tier.units;
                        tierInfo = `Tier ${tier.tier} (${tier.lowerBound}-${tier.upperBound} FUE)`;
                        break;
                    }
                }
            }
            
            document.getElementById('autoAttachCUValue').textContent = autoAttachCU.toLocaleString();
            if (autoAttachCU > 0) {
                document.getElementById('autoAttachTierNote').textContent = tierInfo;
                document.getElementById('autoAttachTierNote').style.display = 'block';
            } else {
                document.getElementById('autoAttachTierNote').style.display = 'none';
            }
            
            // Calculate Datasphere CU
            const datasphereCU = datasphereProduction + datasphereQA + datasphereDEV;
            document.getElementById('datasphereCUValue').textContent = datasphereCU.toLocaleString();
            
            // Calculate SAC BI CU
            let sacBICU = 0;
            let sacBICapacityUnitValue = 0;
            
            if (sacBI >= 25) {
                for (const tier of sacBITable) {
                    if (sacBI >= tier.lowerBound && sacBI <= tier.upperBound) {
                        sacBICapacityUnitValue = tier.capacityUnitValue;
                        sacBICU = Math.ceil(sacBI * sacBICapacityUnitValue);
                        break;
                    }
                }
            }
            
            document.getElementById('sacBICUValue').textContent = sacBICU.toLocaleString();
            if (sacBICU > 0) {
                document.getElementById('sacBINote').textContent = `Capacity Unit Value = ${sacBICapacityUnitValue}`;
                document.getElementById('sacBINote').style.display = 'block';
            } else {
                document.getElementById('sacBINote').style.display = 'none';
            }
            
            // Calculate SAC Planning Standard CU
            let sacPlanningStandardCU = 0;
            let sacPlanningStandardCapacityUnitValue = 0;
            
            if (sacPlanningStandard >= 10) {
                for (const tier of sacPlanningStandardTable) {
                    if (sacPlanningStandard >= tier.lowerBound && sacPlanningStandard <= tier.upperBound) {
                        sacPlanningStandardCapacityUnitValue = tier.capacityUnitValue;
                        sacPlanningStandardCU = Math.ceil(sacPlanningStandard * sacPlanningStandardCapacityUnitValue);
                        break;
                    }
                }
            }
            
            document.getElementById('sacPlanningStandardCUValue').textContent = sacPlanningStandardCU.toLocaleString();
            if (sacPlanningStandardCU > 0) {
                document.getElementById('sacPlanningStandardNote').textContent = `Capacity Unit Value = ${sacPlanningStandardCapacityUnitValue}`;
                document.getElementById('sacPlanningStandardNote').style.display = 'block';
            } else {
                document.getElementById('sacPlanningStandardNote').style.display = 'none';
            }
            
            // Calculate SAC Planning Professional CU
            let sacPlanningProfessionalCU = 0;
            let sacPlanningProfessionalCapacityUnitValue = 0;
            
            if (sacPlanningProfessional >= 1) {
                sacPlanningProfessionalCapacityUnitValue = sacPlanningProfessionalTable[0].capacityUnitValue;
                sacPlanningProfessionalCU = Math.ceil(sacPlanningProfessional * sacPlanningProfessionalCapacityUnitValue);
            }
            
            document.getElementById('sacPlanningProfessionalCUValue').textContent = sacPlanningProfessionalCU.toLocaleString();
            if (sacPlanningProfessionalCU > 0) {
                document.getElementById('sacPlanningProfessionalNote').textContent = `Capacity Unit Value = ${sacPlanningProfessionalCapacityUnitValue}`;
                document.getElementById('sacPlanningProfessionalNote').style.display = 'block';
            } else {
                document.getElementById('sacPlanningProfessionalNote').style.display = 'none';
            }
            
            // Calculate SAC Test Tenant CU
            let sacTestTenantCU = 0;
            let sacTestTenantCapacityUnitValue = 0;
            
            if (sacTestTenant >= 20) {
                sacTestTenantCapacityUnitValue = sacTestTenantTable[0].capacityUnitValue;
                sacTestTenantCU = Math.ceil(sacTestTenant * sacTestTenantCapacityUnitValue);
            }
            
            document.getElementById('sacTestTenantCUValue').textContent = sacTestTenantCU.toLocaleString();
            if (sacTestTenantCU > 0) {
                document.getElementById('sacTestTenantNote').textContent = `Capacity Unit Value = ${sacTestTenantCapacityUnitValue}`;
                document.getElementById('sacTestTenantNote').style.display = 'block';
            } else {
                document.getElementById('sacTestTenantNote').style.display = 'none';
            }
            
            // Update BW PCE CU
            document.getElementById('bwPCECUValue').textContent = bwPCE.toLocaleString();
            
            // Calculate Databricks CU
            const databricksCU = databricksTable[databricksSize].cu;
            document.getElementById('databricksCUValue').textContent = databricksCU.toLocaleString();
            
            if (databricksCU > 0) {
                document.getElementById('databricksNote').textContent = databricksTable[databricksSize].details;
                document.getElementById('databricksNote').style.display = 'block';
            } else {
                document.getElementById('databricksNote').style.display = 'none';
            }
            
            // Calculate Total CU
            const totalCU = autoAttachCU + datasphereCU + sacBICU + sacPlanningStandardCU + 
                          sacPlanningProfessionalCU + sacTestTenantCU + bwPCE + databricksCU;
            document.getElementById('totalCUValue').textContent = totalCU.toLocaleString();
        }
    </script>
</body>
</html>
